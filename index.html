<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>對話探索遊戲</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="game-wrapper">
        <!-- 新增 Loading 畫面 -->
        <div id="loading-screen" style="display: none;">
            <div class="loading-content">
                <div class="spinner"></div>
                <p>資源加載中... <span id="loading-progress">0</span>%</p>
            </div>
        </div>
        <!-- 起始頁面 -->
        <div id="start-menu" class="scene">
            <h1>北斗紅磚市場的微光記憶</h1>
            <button id="startBtn">開始遊戲</button>
            <button id="exitBtn">離開遊戲</button>
        </div>

        <div id="video-scene" class="scene" style="display:none;">
            <video id="intro-video" width="1280" height="720" style="width:100%; height:100%; object-fit:cover;" playsinline>
                <source src="assets/videos/intro.mp4" type="video/mp4">
                您的瀏覽器不支援影片播放。
            </video>
            <button id="skip-video-btn" class="skip-btn">跳過</button>
        </div>

        <!-- 關卡選擇頁面 -->
        <div id="level-select" class="scene" style="display:none;">
            <h2>選擇故事章節</h2>
            <div class="level-buttons">
                <button onclick="loadChapter('chapter1')">第一章：紅磚市場</button>
                <button onclick="loadChapter('chapter2')">第二章：老街記憶</button>
                <button onclick="loadChapter('chapter3')">第三章：時光印記</button>
            </div>
            <button class="back-btn" onclick="showScene('start-menu')">返回</button>
        </div>

        <!-- 遊戲主容器 -->
        <div id="game-container" class="scene" style="display:none;">
            <!-- 背景圖層 -->
            <div id="game-background"></div>
            
            <!-- 角色圖片層 -->
            <div id="character-container">
                <img id="character-image" src="" alt="角色" style="display:none;">
            </div>
            
            <!-- 遊戲畫布（用小遊戲時顯示） -->
            <canvas id="gameCanvas" width="1280" height="720" style="display:none;"></canvas>
            
            <!-- 對話框 -->
            <div id="dialog-box" style="display:none;">
                <div id="npc-name"></div>
                <div id="dialogue-text"></div>
            </div>
            
            <!-- 選項容器 -->
            <div id="options-container"></div>

            <button class="back-btn" onclick="showScene('level-select')" style="display:none;">返回選單</button>
        </div>
        
        <!-- 音效控制（隱藏） -->
        <audio id="bg-music" loop></audio>
        <audio id="sfx-player"></audio>
    </div>

    <!-- ===== 核心引擎 - 注意載入順序 ===== -->
    <!-- 1. 最基本的工具 -->
    <script src="js/core/LoadingManager.js"></script>
    <script src="js/core/GameEngine.js"></script>
    <script src="js/core/AudioManager.js"></script>
    <script src="js/core/SceneManager.js"></script>
    
    <!-- 2. Typewriter 要在 DialogueSystem 之前 -->
    <script src="js/core/Typewriter.js"></script>
    
    <!-- 3. DialogueSystem 依賴 Typewriter -->
    <script src="js/core/DialogueSystem.js"></script>
    
    <!-- 4. 對話資料 -->
    <script src="js/data/intro.js"></script>
    <script src="js/data/chapter1.js"></script>
    <script src="js/data/chapter2.js"></script>
    <script src="js/data/chapter3.js"></script>
    
    <!-- 5. 小遊戲 -->
    <script src="js/minigames/MemoryGame.js"></script>
    <script src="js/minigames/PuzzleGame.js"></script>
    <script src="js/minigames/FindingGame.js"></script>
    
    <!-- 6. 主入口 - 最後載入 -->
    <script src="js/main.js"></script>
</body>
</html>